name: Web3ExplorerWs CD
on:
    push:
      branches:
        - main
env:
    node-version: 20.11.1

permissions:
  contents: write  # Grant write access to contents for release creation

jobs:
  release:
    name: Release pushed tag
    runs-on: ubuntu-22.04
    steps:
      - name: Create release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          tag: v1.0.6
        run: |
          gh release create "$tag" \
              --repo="$GITHUB_REPOSITORY" \
              --title="${tag#v}" \
              --generate-notes
          REPO_NAME=${{ github.repository }}
          TAG_NAME=${{ github.ref_name }}
          RELEASE_URL="https://github.com/${REPO_NAME}/releases/tag/${tag#v}"
          echo "Release URL: $RELEASE_URL"
          echo "::set-output name=release_url::$RELEASE_URL"
  desktop-build:
    name: desktop-build
    runs-on: ubuntu-22.04
    needs: release
    steps:
      - name: echo release_url
        run: |
          echo "Generated Release URL: ${{ needs.create-release.outputs.release_url }}"
